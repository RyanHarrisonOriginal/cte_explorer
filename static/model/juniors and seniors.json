[{"id": "base_seniors", "parentIds": ["candidates"], "sql": "(SELECT experience,\n        sum(salary) OVER(PARTITION BY experience\n                         ORDER BY salary) as running_tot\n FROM   candidates\n WHERE  experience = 'Senior')", "cols": [{"name": "experience", "sql": "experience"}, {"name": "running_tot", "sql": "SUM(salary) OVER(PARTITION BY experience ORDER BY salary) AS running_tot"}]}, {"id": "base_juniors", "parentIds": ["candidates"], "sql": "(SELECT experience,\n        sum(salary) OVER(PARTITION BY experience\n                         ORDER BY salary) as running_tot\n FROM   candidates\n WHERE  experience = 'Junior')", "cols": [{"name": "experience", "sql": "experience"}, {"name": "running_tot", "sql": "SUM(salary) OVER(PARTITION BY experience ORDER BY salary) AS running_tot"}]}, {"id": "seniors", "parentIds": ["base_seniors"], "sql": "(SELECT 'Senior' as experience,\n        count(1) as accepted_candidates,\n        case when max(running_tot) < 70000 then 70000 - max(running_tot)\n             else 70000 end as remaining_tot\n FROM   base_seniors\n WHERE  running_tot < 70000)", "cols": [{"name": "experience", "sql": "'Senior' AS experience"}, {"name": "accepted_candidates", "sql": "COUNT(1) AS accepted_candidates"}, {"name": "remaining_tot", "sql": "CASE WHEN MAX(running_tot) < 70000 THEN 70000 - MAX(running_tot) ELSE 70000 END AS remaining_tot"}]}, {"id": "juniors", "parentIds": ["base_juniors"], "sql": "(SELECT 'Junior' as experience,\n        count(1) as accepted_candidates\n FROM   base_juniors)", "cols": [{"name": "experience", "sql": "'Junior' AS experience"}, {"name": "accepted_candidates", "sql": "COUNT(1) AS accepted_candidates"}]}, {"id": "final", "parentIds": ["seniors", "juniors"], "sql": "(SELECT experience,\n        accepted_candidates\n FROM   seniors\n UNION all\nSELECT experience,\n        accepted_candidates\n FROM   juniors)", "cols": [{"name": "experience", "sql": "experience"}, {"name": "accepted_candidates", "sql": "accepted_candidates"}]}, {"id": "candidates", "sql": "select * from candidates", "cols": [{"name": "all", "sql": "*"}]}]