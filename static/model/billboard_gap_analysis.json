[{"id": "base", "parentIds": ["fct_chart_performance"], "sql": "(SELECT track_id,\n        chart_name,\n        case when is_most_recent_feature then chart_date\n             else null end as last_week,\n        case when is_chart_debut then chart_date\n             else null end as first_week\n FROM   fct_chart_performance\n WHERE  track_id is not null\n    and (is_chart_debut\n     or is_most_recent_feature))", "cols": [{"name": "track_id", "sql": "track_id"}, {"name": "chart_name", "sql": "chart_name"}, {"name": "last_week", "sql": "CASE WHEN is_most_recent_feature THEN chart_date ELSE NULL END AS last_week"}, {"name": "first_week", "sql": "CASE WHEN is_chart_debut THEN chart_date ELSE NULL END AS first_week"}]}, {"id": "final", "parentIds": ["base", "dim_tracks", "dim_artists"], "sql": "(SELECT track_id,\n        concat(track_name,\n               ' by ',\n               artist_name) as track_name,\n        chart_name,\n        date_diff(max(last_week),\n                  max(first_week)) as n_weeks_debut_to_last_seen,\n        date_diff(max(release_date),\n                  max(first_week)) as n_weeks_release_to_debut\n FROM   base\n     LEFT JOIN dim_tracks as track\n         ON base.track_id = track.track_id\n     LEFT JOIN dim_artists as artist\n         ON base.artist_id = artist.artist_id\n GROUP BY 1, 2, 3\n ORDER BY 5 desc)", "cols": [{"name": "track_id", "sql": "track_id"}, {"name": "track_name", "sql": "CONCAT(track_name, ' by ', artist_name) AS track_name"}, {"name": "chart_name", "sql": "chart_name"}, {"name": "n_weeks_debut_to_last_seen", "sql": "DATE_DIFF(MAX(last_week), MAX(first_week)) AS n_weeks_debut_to_last_seen"}, {"name": "n_weeks_release_to_debut", "sql": "DATE_DIFF(MAX(release_date), MAX(first_week)) AS n_weeks_release_to_debut"}]}, {"id": "fct_chart_performance", "sql": "select * from fct_chart_performance", "cols": [{"name": "all", "sql": "*"}]}, {"id": "dim_tracks", "sql": "select * from dim_tracks", "cols": [{"name": "all", "sql": "*"}]}, {"id": "dim_artists", "sql": "select * from dim_artists", "cols": [{"name": "all", "sql": "*"}]}]