[{"id": "base", "parentIds": ["analytics.fct_chart_performance"], "sql": "(SELECT track_id,\n        chart_name,\n        case when is_most_recent_feature then chart_date\n             else null end as last_week,\n        case when is_chart_debut then chart_date\n             else null end as first_week\n FROM   analytics.fct_chart_performance\n WHERE  track_id is not null\n    and (is_chart_debut\n     or is_most_recent_feature))", "cols": [{"name": "track_id", "sql": "track_id"}, {"name": "chart_name", "sql": "chart_name"}, {"name": "last_week", "sql": "CASE WHEN is_most_recent_feature THEN chart_date ELSE NULL END AS last_week"}, {"name": "first_week", "sql": "CASE WHEN is_chart_debut THEN chart_date ELSE NULL END AS first_week"}]}, {"id": "final", "parentIds": ["analytics.dim_artists", "base", "analytics.dim_tracks"], "sql": "(SELECT track_id,\n        concat(track_name,\n               ' by ',\n               artist_name) as track_name,\n        chart_name,\n        date_diff(max(last_week),\n                  max(first_week)) as time_debut_to_latest,\n        date_diff(max(release_date),\n                  max(first_week)) as time_release_to_debut\n FROM   base\n     LEFT JOIN analytics.dim_tracks as track\n         ON lt.track_id = rt.track_id\n     LEFT JOIN analytics.dim_artists as artist\n         ON lt.artist_id = rt.artist_id\n GROUP BY 1, 2, 3\n ORDER BY 5 desc)", "cols": [{"name": "track_id", "sql": "track_id"}, {"name": "track_name", "sql": "CONCAT(track_name, ' by ', artist_name) AS track_name"}, {"name": "chart_name", "sql": "chart_name"}, {"name": "time_debut_to_latest", "sql": "DATE_DIFF(MAX(last_week), MAX(first_week)) AS time_debut_to_latest"}, {"name": "time_release_to_debut", "sql": "DATE_DIFF(MAX(release_date), MAX(first_week)) AS time_release_to_debut"}]}, {"id": "analytics.fct_chart_performance", "parentIds": [], "sql": "select * from analytics.fct_chart_performance", "cols": [{"name": "all", "sql": "*"}]}, {"id": "analytics.dim_artists", "parentIds": [], "sql": "select * from analytics.dim_artists", "cols": [{"name": "all", "sql": "*"}]}, {"id": "analytics.dim_tracks", "parentIds": [], "sql": "select * from analytics.dim_tracks", "cols": [{"name": "all", "sql": "*"}]}]