[{"id": "detailed_data", "parentIds": ["Order_Item", "Category", "Products", "Orders"], "sql": "(SELECT o.order_date,\n        c.category_name,\n        p.product_name,\n        oi.quantity,\n        oi.listprice,\n        oi.discount\n FROM   orders as o\n     LEFT JOIN order_item as oi\n         ON o.id = oi.id\n     LEFT JOIN products as p\n         ON o.prd_id = p.id\n     LEFT JOIN category as c\n         ON o.cat_id = c.id)", "cols": [{"name": "order_date", "sql": "o.order_date"}, {"name": "category_name", "sql": "c.category_name"}, {"name": "product_name", "sql": "p.product_name"}, {"name": "quantity", "sql": "oi.quantity"}, {"name": "listprice", "sql": "oi.listprice"}, {"name": "discount", "sql": "oi.discount"}]}, {"id": "product_sales", "parentIds": ["detailed_data"], "sql": "(SELECT year(dt.order_date) as year,\n        month(dt.order_date) as month,\n        dt.category_name,\n        dt.product_name,\n        sum(dt.quantity) as total_quantity,\n        sum(dt.listprice * (1 - dt.discount)) as total_product_sales\n FROM   detailed_data as dt\n GROUP BY 1, 2, 3, 4)", "cols": [{"name": "year", "sql": "YEAR(dt.order_date) AS year"}, {"name": "month", "sql": "MONTH(dt.order_date) AS month"}, {"name": "category_name", "sql": "dt.category_name"}, {"name": "product_name", "sql": "dt.product_name"}, {"name": "total_quantity", "sql": "SUM(dt.quantity) AS total_quantity"}, {"name": "total_product_sales", "sql": "SUM(dt.listprice * (1 - dt.discount)) AS total_product_sales"}]}, {"id": "last_month_data", "parentIds": ["product_sales"], "sql": "(SELECT ps.*\n FROM   product_sales as ps\n WHERE  ps.year = year(current_date) - 1\n    and ps.month = month(current_date) - 1)", "cols": [{"name": "", "sql": "ps.*"}]}, {"id": "prev_month_data", "parentIds": ["product_sales"], "sql": "(SELECT ps.*\n FROM   product_sales as ps\n WHERE  ps.year = year(current_date) - 2\n    and ps.month = month(current_date) - 2)", "cols": [{"name": "", "sql": "ps.*"}]}, {"id": "final", "parentIds": ["prev_month_data", "last_month_data"], "sql": "(SELECT lmd.*\n FROM   last_month_data as lmd\n     LEFT JOIN prev_month_data as pmd\n         ON lmd.category_name = pmd.category_name)", "cols": [{"name": "", "sql": "lmd.*"}]}, {"id": "Order_Item", "sql": "select * from Order_Item", "cols": [{"name": "all", "sql": "*"}]}, {"id": "Category", "sql": "select * from Category", "cols": [{"name": "all", "sql": "*"}]}, {"id": "Products", "sql": "select * from Products", "cols": [{"name": "all", "sql": "*"}]}, {"id": "Orders", "sql": "select * from Orders", "cols": [{"name": "all", "sql": "*"}]}]