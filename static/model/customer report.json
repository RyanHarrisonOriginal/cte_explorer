[{"id": "sales_customer", "parentIds": ["dbo.fct_internet_sales", "dbo.DimCustomer"], "sql": "(SELECT fs.orderdatekey,\n        fs.productkey,\n        fs.orderquantity * fs.unitprice as totalsale,\n        dc.firstname,\n        dc.lastname\n FROM   dbo.fct_internet_sales as fs\n     INNER JOIN dbo.dimcustomer as dc\n         ON dc.customerkey = fs.customerkey)", "cols": [{"name": "OrderDateKey", "sql": "fs.OrderDateKey"}, {"name": "ProductKey", "sql": "fs.ProductKey"}, {"name": "TotalSale", "sql": "fs.OrderQuantity * fs.UnitPrice AS TotalSale"}, {"name": "FirstName", "sql": "dc.FirstName"}, {"name": "LastName", "sql": "dc.LastName"}]}, {"id": "cal_date", "parentIds": ["dbo.DimDate"], "sql": "(SELECT datekey,\n        calendaryear\n FROM   dbo.dimdate)", "cols": [{"name": "DateKey", "sql": "DateKey"}, {"name": "CalendarYear", "sql": "CalendarYear"}]}, {"id": "final", "parentIds": ["sales_customer", "cal_date"], "sql": "(SELECT calendaryear,\n        productkey,\n        sum(totalsale) as totalsales\n FROM   sales_customer\n     INNER JOIN cal_date\n         ON cal_date.datekey = sales_customer.orderdatekey\n GROUP BY calendaryear, productkey\n ORDER BY calendaryear, totalsales desc)", "cols": [{"name": "CalendarYear", "sql": "CalendarYear"}, {"name": "ProductKey", "sql": "ProductKey"}, {"name": "TotalSales", "sql": "SUM(TotalSale) AS TotalSales"}]}, {"id": "dbo.fct_internet_sales", "sql": "select * from dbo.fct_internet_sales", "cols": [{"name": "all", "sql": "*"}]}, {"id": "dbo.DimCustomer", "sql": "select * from dbo.DimCustomer", "cols": [{"name": "all", "sql": "*"}]}, {"id": "dbo.DimDate", "sql": "select * from dbo.DimDate", "cols": [{"name": "all", "sql": "*"}]}]