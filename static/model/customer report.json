[{"id": "Sales_Cust_Join_CTE", "parentIds": ["dbo.FactInternetSales", "dbo.DimCustomer"], "sql": "(SELECT fs.orderdatekey,\n        fs.productkey,\n        fs.orderquantity * fs.unitprice as totalsale,\n        dc.firstname,\n        dc.lastname\n FROM   dbo.factinternetsales as fs\n     INNER JOIN dbo.dimcustomer as dc\n         ON dc.customerkey = fs.customerkey)", "cols": [{"name": "OrderDateKey", "sql": "fs.OrderDateKey"}, {"name": "ProductKey", "sql": "fs.ProductKey"}, {"name": "TotalSale", "sql": "fs.OrderQuantity * fs.UnitPrice AS TotalSale"}, {"name": "FirstName", "sql": "dc.FirstName"}, {"name": "LastName", "sql": "dc.LastName"}]}, {"id": "Date_CTE", "parentIds": ["dbo.DimDate"], "sql": "(SELECT datekey,\n        calendaryear\n FROM   dbo.dimdate)", "cols": [{"name": "DateKey", "sql": "DateKey"}, {"name": "CalendarYear", "sql": "CalendarYear"}]}, {"id": "final", "parentIds": ["Sales_Cust_Join_CTE", "Date_CTE"], "sql": "(SELECT calendaryear,\n        productkey,\n        sum(totalsale) as totalsales\n FROM   sales_cust_join_cte\n     INNER JOIN date_cte\n         ON date_cte.datekey = sales_cust_join_cte.orderdatekey\n GROUP BY calendaryear, productkey\n ORDER BY calendaryear, totalsales desc)", "cols": [{"name": "CalendarYear", "sql": "CalendarYear"}, {"name": "ProductKey", "sql": "ProductKey"}, {"name": "TotalSales", "sql": "SUM(TotalSale) AS TotalSales"}]}, {"id": "dbo.FactInternetSales", "sql": "select * from dbo.FactInternetSales", "cols": [{"name": "all", "sql": "*"}]}, {"id": "dbo.DimCustomer", "sql": "select * from dbo.DimCustomer", "cols": [{"name": "all", "sql": "*"}]}, {"id": "dbo.DimDate", "sql": "select * from dbo.DimDate", "cols": [{"name": "all", "sql": "*"}]}]