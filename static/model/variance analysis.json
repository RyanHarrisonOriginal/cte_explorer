[{"id": "cy", "parentIds": ["fct_sales"], "sql": "(SELECT material_id,\n        product_id,\n        customer_id,\n        sbu_id,\n        market_segment_id,\n        sum(contribution_margin) as cm\n FROM   fct_sales\n WHERE  year = 2022\n GROUP BY 1, 2, 3, 4, 5)", "cols": [{"name": "material_id", "sql": "material_id"}, {"name": "product_id", "sql": "product_id"}, {"name": "customer_id", "sql": "customer_id"}, {"name": "sbu_id", "sql": "sbu_id"}, {"name": "market_segment_id", "sql": "market_segment_id"}, {"name": "cm", "sql": "SUM(contribution_margin) AS cm"}]}, {"id": "py", "parentIds": ["fct_sales"], "sql": "(SELECT material_id,\n        product_id,\n        customer_id,\n        sbu_id,\n        market_segment_id,\n        sum(contribution_margin) as cm\n FROM   fct_sales\n WHERE  year = 2021\n GROUP BY 1, 2, 3, 4, 5)", "cols": [{"name": "material_id", "sql": "material_id"}, {"name": "product_id", "sql": "product_id"}, {"name": "customer_id", "sql": "customer_id"}, {"name": "sbu_id", "sql": "sbu_id"}, {"name": "market_segment_id", "sql": "market_segment_id"}, {"name": "cm", "sql": "SUM(contribution_margin) AS cm"}]}, {"id": "a06", "parentIds": ["py", "cy"], "sql": "(SELECT coalesce(py.material_id,\n                 py.material_id) as material_id,\n        coalesce(py.product_id,\n                 cy.product_id) as product_id,\n        coalesce(py.customer_id,\n                 cy.customer_id) as customer_id,\n        coalesce(py.sbu_id,\n                 cy.sbu_id) as sbu_id,\n        coalesce(py.market_segment_id,\n                 cy.market_segment_id) as market_segment_id,\n        py.cm - cy.cm as yoy_delta\n FROM   cy\n     LEFT JOIN py\n         ON cy.material_id = py.material_id and\n            cy.product_id = py.product_id and\n            cy.customer_id = py.customer_id and\n            cy.sbu_id = py.sbu_id and\n            cy.market_segment_id = py.market_segment_id)", "cols": [{"name": "material_id", "sql": "COALESCE(py.material_id, py.material_id) AS material_id"}, {"name": "product_id", "sql": "COALESCE(py.product_id, cy.product_id) AS product_id"}, {"name": "customer_id", "sql": "COALESCE(py.customer_id, cy.customer_id) AS customer_id"}, {"name": "sbu_id", "sql": "COALESCE(py.sbu_id, cy.sbu_id) AS sbu_id"}, {"name": "market_segment_id", "sql": "COALESCE(py.market_segment_id, cy.market_segment_id) AS market_segment_id"}, {"name": "yoy_delta", "sql": "py.cm - cy.cm AS yoy_delta"}]}, {"id": "fct_sales", "sql": "select * from fct_sales", "cols": [{"name": "all", "sql": "*"}]}]